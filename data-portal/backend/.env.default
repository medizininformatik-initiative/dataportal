# --- API Configuration ---
# Allowed CORS origins for the API
# Subdomain mode: https://datenportal.localhost
# Context path mode: https://localhost
# Default: https://datenportal.localhost
ALLOWED_ORIGINS=https://datenportal.localhost

# Base URL for the API endpoint
# Subdomain mode: https://api.datenportal.localhost
# Context path mode: https://localhost/backend
# Default: https://api.datenportal.localhost
API_BASE_URL=https://api.datenportal.localhost

# --- Database Configuration ---
# Database host address
# Default: dataportal-postgres
DATABASE_HOST=dataportal-postgres

# Database port
# Default: 5432
DATABASE_PORT=5432

# Database name
# Default: dataportal
DATABASE_DBNAME=dataportal

# Database username
# Default: guidbuser
DATABASE_USER=guidbuser

# Database password
# Default: guidbpw
DATABASE_PASSWORD=guidbpw

# Show SQL statements in logs
# Default: false
HIBERNATE_SHOW_SQL=false

# --- Keycloak Configuration ---
# Keycloak issuer base URL (external/public facing)
# Subdomain mode: https://auth.datenportal.localhost
# Context path mode: https://localhost/auth
# Default: https://auth.datenportal.localhost
KEYCLOAK_BASE_URL_ISSUER=https://auth.datenportal.localhost

# Keycloak JWK base URL (internal)
# Default: http://auth:8080
KEYCLOAK_BASE_URL_JWK=http://auth:8080

# Keycloak realm name
# Default: dataportal
KEYCLOAK_REALM=dataportal

# Basic user role for data portal access
# Default: DataportalUser
KEYCLOAK_ALLOWED_ROLE=DataportalUser

# Power user role with extended permissions
# Default: DataportalPowerUser
KEYCLOAK_POWER_ROLE=DataportalPowerUser

# Administrator role with full permissions
# Default: DataportalAdmin
KEYCLOAK_ADMIN_ROLE=DataportalAdmin

# --- Elasticsearch Configuration ---
# Enable Elasticsearch integration
# Default: true
ELASTIC_SEARCH_ENABLED=true

# Elasticsearch host address
# Default: dataportal-elastic
ELASTIC_SEARCH_HOST=dataportal-elastic

# Comma-separated list of filters to apply
# Default: context,terminology,kds_module
ELASTIC_SEARCH_FILTER=context,terminology,kds_module

# Exit initialization if indices already exist
# Default: true
DATAPORTAL_ES_INIT_EXIT_ON_EXISTING_INDICES=true

# --- Query Execution Configuration ---
# Maximum number of saved queries per user
# Default: 100
MAX_SAVED_QUERIES_PER_USER=100

# Enable FHIR query translation
# Default: false
FHIR_TRANSLATE_ENABLED=false

# Enable CQL (Clinical Quality Language) query translation
# Default: true
CQL_TRANSLATE_ENABLED=true

# Enable query validation before execution
# Default: true
QUERY_VALIDATION_ENABLED=true

# Query result expiry duration (ISO 8601 duration)
# Default: PT5M (5 minutes)
QUERYRESULT_EXPIRY=PT5M

# --- Direct Request Broker Configuration ---
# Enable mock broker client (for testing)
# Default: false
BROKER_CLIENT_MOCK_ENABLED=false

# Enable direct broker client
# Default: true
BROKER_CLIENT_DIRECT_ENABLED=true

# Basic authentication username (leave empty if not using basic auth)
# Default: (empty)
BROKER_CLIENT_DIRECT_AUTH_BASIC_USERNAME=

# Basic authentication password (leave empty if not using basic auth)
# Default: (empty)
BROKER_CLIENT_DIRECT_AUTH_BASIC_PASSWORD=

# OAuth issuer URL for broker authentication
# Subdomain mode: https://auth.localhost:444/realms/blaze
# Context path mode: https://localhost:444/auth/realms/blaze
# Default: https://auth.localhost:444/realms/blaze
BROKER_CLIENT_DIRECT_AUTH_OAUTH_ISSUER_URL=https://auth.localhost:444/realms/blaze

# OAuth client ID
# Default: account
BROKER_CLIENT_DIRECT_AUTH_OAUTH_CLIENT_ID=account

# OAuth client secret
# Default: insecure
BROKER_CLIENT_DIRECT_AUTH_OAUTH_CLIENT_SECRET=insecure

# Use CQL for direct broker queries
# Default: true
BROKER_CLIENT_DIRECT_USE_CQL=true

# CQL server base URL
# Default: http://fhir-server:8080/fhir
CQL_SERVER_BASE_URL=http://fhir-server:8080/fhir

# Use asynchronous CQL execution
# Default: false
BROKER_CLIENT_DIRECT_CQL_USE_ASYNC=false

# Flare webservice base URL
# Default: http://flare:8080
FLARE_WEBSERVICE_BASE_URL=http://flare:8080

# Obfuscate result counts in responses
# Default: false
BROKER_CLIENT_OBFUSCATE_RESULT_COUNT=false

# Timeout for direct broker requests (ISO 8601 duration)
# Default: PT20S (20 seconds)
BROKER_CLIENT_DIRECT_TIMEOUT=PT20S

# --- DSF (Data Sharing Framework) Broker Configuration ---
# Enable DSF broker client
# Default: false
BROKER_CLIENT_DSF_ENABLED=false

# Path to CA certificate for DSF
# Default: /opt/dsf-secrets/ca.pem
DSF_SECURITY_CACERT=/opt/dsf-secrets/ca.pem

# Path to client certificate for DSF
# Default: /opt/dsf-secrets/cert.pem
DSF_SECURITY_CLIENT_CERTIFICATE_FILE=/opt/dsf-secrets/cert.pem

# Path to client private key for DSF
# Default: /opt/dsf-secrets/key.pem
DSF_SECURITY_CLIENT_KEY_FILE=/opt/dsf-secrets/key.pem

# Client key password
# Default: insecure
DSF_SECURITY_CLIENT_KEY_PASSWORD=insecure

# Proxy host (leave empty if not using proxy)
# Default: (empty)
DSF_PROXY_HOST=

# Proxy username (leave empty if not using proxy)
# Default: (empty)
DSF_PROXY_USERNAME=

# Proxy password (leave empty if not using proxy)
# Default: (empty)
DSF_PROXY_PASSWORD=

# DSF webservice base URL
# Default: https://dsf-zars-fhir-proxy/fhir
DSF_WEBSERVICE_BASE_URL=https://dsf-zars-fhir-proxy/fhir

# Log DSF webservice requests
# Default: false
DSF_WEBSERVICE_LOG_REQUESTS=false

# DSF WebSocket URL for real-time communication
# Default: wss://dsf-zars-fhir-proxy:443/fhir/ws
DSF_WEBSOCKET_URL=wss://dsf-zars-fhir-proxy:443/fhir/ws

# DSF organization identifier
# Default: Test_ZARS
DSF_ORGANIZATION_ID=Test_ZARS

# --- Privacy Configuration ---
# Minimum number of sites required for query execution
# Default: 1
PRIVACY_THRESHOLD_SITES=1

# Minimum result count threshold (0 = no minimum)
# Default: 0
PRIVACY_THRESHOLD_RESULTS=0

# Minimum result count threshold per site (0 = no minimum)
# Default: 0
PRIVACY_THRESHOLD_SITES_RESULT=0

# Soft quota: number of queries allowed in the interval
# Default: 3
PRIVACY_QUOTA_SOFT_CREATE_AMOUNT=3

# Soft quota: time interval (ISO 8601 duration)
# Default: PT1M (1 minute)
PRIVACY_QUOTA_SOFT_CREATE_INTERVAL=PT1M

# Hard quota: number of queries allowed in the interval
# Default: 50
PRIVACY_QUOTA_HARD_CREATE_AMOUNT=50

# Hard quota: time interval (ISO 8601 duration)
# Default: P7D (7 days)
PRIVACY_QUOTA_HARD_CREATE_INTERVAL=P7D

# Polling interval for reading summary results (ISO 8601 duration)
# Default: PT5S (5 seconds)
PRIVACY_QUOTA_READ_SUMMARY_POLLINGINTERVAL=PT5S

# Polling interval for reading detailed obfuscated results (ISO 8601 duration)
# Default: PT10S (10 seconds)
PRIVACY_QUOTA_READ_DETAILED_OBFUSCATED_POLLINGINTERVAL=PT10S

# Number of detailed obfuscated reads allowed in the interval
# Default: 10
PRIVACY_QUOTA_READ_DETAILED_OBFUSCATED_AMOUNT=10

# Time interval for detailed obfuscated read quota (ISO 8601 duration)
# Default: PT2H (2 hours)
PRIVACY_QUOTA_READ_DETAILED_OBFUSCATED_INTERVAL=PT2H

# --- UI Configuration ---
# CCDL (Clinical-Cohort-Definition-Language) version identifier
# Default: unknown
PT_CCDL_VERSION=unknown

# Link to the proposal portal
# Default: https://antrag.forschen-fuer-gesundheit.de
PT_PORTAL_LINK=https://antrag.forschen-fuer-gesundheit.de

# URL to the DSE patient profile structure definition
# Default: https://www.medizininformatik-initiative.de/fhir/core/modul-person/StructureDefinition/PatientPseudonymisiert
PT_DSE_PATIENT_PROFILE_URL=https://www.medizininformatik-initiative.de/fhir/core/modul-person/StructureDefinition/PatientPseudonymisiert

# Polling interval for UI updates (ISO 8601 duration)
# Default: PT1M (1 minute)
PT_POLLING_TIME_UI=PT1M

# Polling interval for summary updates (ISO 8601 duration)
# Default: PT10S (10 seconds)
PT_POLLING_SUMMARY=PT10S

# --- Application Configuration ---
# Cron expression for purging expired queries
# Default: 0 0 * * * * (every hour at minute 0)
PURGE_EXPIRED_QUERIES=0 0 * * * *

# CSV export delimiter character
# Default: ;
EXPORT_CSV_DELIMITER=;

# CSV export text wrapper character
# Default: "
EXPORT_CSV_TEXTWRAPPER="

# --- Logging Configuration ---
# SQL logging level (trace, debug, info, warn, error)
# Default: info
LOG_LEVEL_SQL=info

# General application logging level (trace, debug, info, warn, error)
# Default: info
LOG_LEVEL=info